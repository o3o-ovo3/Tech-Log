# TCP와 UDP

:writing_hand: *Assembled by Yunju Jang*

🤝*Contributors :  JiYoung-Kwon, Jeonghea Shin* 

<hr>


-  <b>전송계층</b>
   -  IP에 의해 전달되는 패킷의 오류를 검사하고 재전송 요구 등의 제어를 담당하는 계층이다.
      -  TCP와 UDP는 TCP/IP의 전송계층에서 사용되는 프로토콜이다.
   -  IP 프로토콜을 기반으로 구현된다.

<br/>

<br/>

### TCP (Transmission Control Protocol)

- <b>TCP 란? </b>

  - 전송을 제어하는 프로토콜

  - 인터넷 상에서 데이터를 메시지의 형태로 본기 위해 IP와 함께 사용한다.

  - <mark>신뢰성</mark>을 보장하는 연결형 서비스

  - 네트워크에 연결된 컴퓨터에서 실행되는 프로그램 간에 일련의 옥텟*을 <mark>안정적</mark>으로, <mark>순서</mark>대로, <mark>에러 없이</mark> 교환한다.

    <small>* 옥텟 : 데이터, 메시지, 세그먼트라는 블록 단위</small>

  - 전화 통화 방식과 유사하다.

  <br/>

- <b>TCP의 특징</b>

  - <b>연결형 서비스</b>로, 가상 회선 방식을 제공한다.

    - 3-way handshaking 과정을 통해 연결을 설정한다.
    - 4-way handshaking을 통해 연결을 해제한다.

    > <img src='../resources/TCP.png' width='400px' align='center'>
    >
    > <b>3-way handshaking</b>
    >
    > -  데이터를 전송 전, 정확한 전송을 보장하기 위해 상대방 컴퓨터와 사전에 세션을 수립하는 과정을 의미한다.
    > - Client -> server : SYN 패킷을 보내고 응답을 기다린다.
    > - Server -> Client : 요청을 받고, 요청을 수락한다는 ACK와 패킷을 발송하고, ACK 응답을 기다린다.
    > - Client -> Server : ACK을 보낸다.
    >
    > <br/>
    >
    > <br/>
    >
    > <b>4-way handshaking</b>
    >
    > - 3-way는 TCP 연결 초기화 시 사용한다면, 4-way는 세션을 종료하기 위해 수행된다.
    > - Client -> Server : 연결 종료를 요청하는 FIN 플래그를 전송한다.
    > - Server -> Client : 확인 메시지를 보낸다.
    > - Server -> Client : 통신이 끝났으면 FIN 플래그를 전송한다.
    > - Client -> Server : 확인 메시지를 보낸다.

    <br/>

  - 흐름 제어 (Flow control)

    - 송신측과 수신측<small>(호스트-호스트)</small>의 데이터 처리 속도 차이를 해결하기 위한 기법이다.
    - 송신측이 수신측 보다 빠르면 데이터 전송을 줄인다.
    - 이를 통해 수신자의 버퍼 오버플로우를 방지한다.

    <br/>

  - 혼잡 제어 (Congestion control)

    - 송신측의 데이터 전달과 네트워크의 데이터 처리 속도 차이를 해결하기 위한 기법이다.<small>호스트-네트워크</small>
    - 네트워크의 혼잡을 피하기 위해 송신측에서 보내는 데이터의 전송 속도를 강제로 줄인다.
    - 이를 통해 네트워크 내의 패킷 수가 넘치게 증가하지 않도록 방지한다.

    <br/>

  - 높은 <b>신뢰성</b> 보장

    - Dupack-based retransmission

      - 정상적인 상황에서는 ACK 값이 연속적으로 전송된다.
      - ACK 값이 중복으로 올 경우 패킷 이상을 감지하고 재전송을 요청한다.

      <br/>

    - Timeout-based retransmission

      - 일정 시간 동안 ACK 값이 수신되지 않을 경우 재전송을 요청한다.

    <br/>

  - 전이중, 점대점 방식

    - 전이중 (Full-Duplex)
      - 전송이 양방향으로 동시에 일어날 수 있다.
    - 점대점 (Point to Point)
      - 각 연결이 정확히 2개의 종단점을 가지고 있다.

    <br/>

  - UDP 보다 속도가 느리다. 연속성 보다는 신뢰성이 중요한 서비스에 사용한다.

  <br/>

  <br/>

- <b>TCP 서버의 특징</b>

  - 서버 소켓은 연결만을 담당한다.

  - 연결 과정에서 반환된 클라이언트 소켓은 데이터의 송수신에 사용된다.

  - 서버와 클라이언트는 1:1로 연결된다.

  - 스트림 전송으로, 전송 데이터의 크기가 무제한이다.

  - 패킷*에 대한 응답을 해야하기 때문에 성능이 낮다.

    <small>패킷 : 효율적인 데이터 전송 경로배정을 위해 데이터를 여러 개로 나눈 조각</small>

  - 손실된 경우 재전송을 요청하기 때문에 스트리밍 서비스에 불리하다.

<br/>

<br/>

### UDP (User Datagram Protocol)

- <b>UDP란?</b>

  - <mark>비연결형</mark> 프로토콜이다.

  - 데이터를 데이터그램* 단위로 처리한다.

    <small>데이터그램 : 독립적인 관계를 지니는 패킷</small>

  - 편지를 보내는 방식과 유사하다.

  <br/>

- <b>UDP의 특징</b>

  - 비연결형 서비스로, 연결을 설정하고 해제하는 과정이 존재하지 않는다.

    <img src='../resources/UDP.png' width='400px' align='center'>

  - 정보를 주고 받을 때 정보를 보내거나 받았다는 신호 절차를 거치지 않는다.

  - UDP 헤더의 CheckSum 필드를 통해 최소한의 오류만을 검출한다.

  - <mark>비신뢰성</mark>이다.

    - 데이터 전송에 대한 보장을 하지 않아 패킷 손실이 발생할 수 있다.

  - 혼잡 제어를 하지 않아 TCP보다 속도가 <mark>빠르다.</mark>

  - 신뢰성 보다는 연속성이 중요한 서비스에 사용한다. <small>ex) 실시간 서비스 (Streaming)</small>

  <br/>

  <br/>

- <b>UDP 서버의 특징</b>

  - UDP는 연결 자체가 없어 connect 함수가 필요하지 않다.
  - 소켓 대신 IP를 기반으로 데이터를 전송한다.
  - 서버와 클라이언트는 1:1, 1:N:, N:M 등으로 연결될 수 있따.
  - 65535바이트 데이터그램 크기의 단위로 전송되고, 이를 초과하면 잘라서 보낸다.
  - 흐름제어가 없어 제대로 전송되었는지, 오류가 없는지 확인할 수 없다.
  - 파일 전송과 같은 신뢰성이 필요한 서비스보다 성능이 중요시 되는 경우 사용된다.

  <br/>

  <br/>

### TCP와 UDP 비교

- <b>공통점</b>

  - 포트 번호를 이용하여 주소를 지정한다.
  - 데이터 오류 검사를 위한 CheckSum이 존재한다.

  <br/>

- 차이점

  | 프로토콜 종류      | TCP                                                          | UDP                                                          |
  | ------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
  | 연결 방식          | 연결형 서비스                                                | 비연결형 서비스                                              |
  | 혼잡제어, 흐름제어 | 혼잡제어, 흐름제어                                           | 혼잡제어, 흐름제어 지원 X                                    |
  | 패킷 교환 방식     | 가상 회선 방식                                               | 데이터그램 방식                                              |
  | 전송 순서          | 전송 순서 보장                                               | 전송 순서 바뀔 수 있음                                       |
  | 수신 여부 확인     | 수신 여부 확인                                               | 수신 여부 확인 X                                             |
  | 통신 방식          | 1:1 통신                                                     | 1:1 or 1:N or N:N 통신                                       |
  | 신뢰성             | 높음                                                         | 낮음                                                         |
  | 속도               | 느림                                                         | 빠름                                                         |
  | 송신 과정          | <img src='../resources/TCPsending.png' width='300px' align='center'> | <img src='../resources/UDPsending.png' width='300px' align='center'> |

<br/>

<br/>

## 예상질문❔

Q1) TCP의 특징은 무엇인가?

A1) TCP는 전송 제어 프로토콜로, 연결형 서비스 방식을 이용한다. 수신측의 수신 여부를 확인하고 데이터를 순서대로 보내기 때문에 신뢰성이 높다. 그러나 속도가 느리기 때문에 실시간 서비스에는 적합하지 않다.

<br/>

Q2) UDP의 특징은 무엇인가?

A2) UDP는 전송 제어 프로토콜로, 비연결형 서비스 방식이다. 전송 순서와 수신여부를 신경쓰지 않기 때문에 신뢰성이 비교적 낮다. TCP와 다르게 혼잡제어나 흐름제어를 제공하지 않아 속도가 빠르다. 실시간 서비스와 같이 속도가 중요한 서비스에 적합하다.

<br/>

Q3) 흐름제어와 혼잡제어의 차이는 무엇인가?

A3) 흐름제어는 송신측과 수신측 간의 속도 차이를 제어하는 것으로, 수신측의 데이터 수신 속도 보다 송신측의 데이터 전송 속도가 빠를 경우 강제로 전송 속도를 제어하여 수신측의 버퍼 오버플로우가 발생하지 않도록 제어하는 것이다.

혼잡제어의 경우, 흐름제어 처럼 호스트 간의 속도를 제어하는 게 아니라, 송신측과 네트워크의 속도 차이를 제어하는 것이다. 송신측의 데이터 전송 속도가 이를 뒷받침하는 네트워크의 속도보다 빠를 경우 강제로 송신측의 속도를 제어하여 네트워크의 패킷 수가 넘치지 않도록하고, 혼잡을 피한다.

<br/>

<br/>

### Reference📖

- https://proneer.tistory.com/entry/%ED%9D%90%EB%A6%84%EC%A0%9C%EC%96%B4%EC%99%80-%ED%98%BC%EC%9E%A1%EC%A0%9C%EC%96%B4Flow-control-Congestion-control
- https://mindnet.tistory.com/entry/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%89%BD%EA%B2%8C-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0-22%ED%8E%B8-TCP-3-WayHandshake-4-WayHandshake
- https://github.com/fake-developers/1st/blob/main/KJY/%5BNETWORK%5D%20TCP%EC%99%80%20UDP.md
- https://github.com/fake-developers/1st/blob/Main/SJH/TCP&UDP.md

